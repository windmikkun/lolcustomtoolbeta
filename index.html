<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LoL Custom Team Balancer</title>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <header>
        <h1>LoL Custom Team Balancer(β)</h1>
        <p>
            最高ランク入力推奨 / メイン・サブ同レート計算 / それ以外は tier-2（-2division） / 総合差＋対面差を考慮して計算します。
        </p>
    </header>

    <main>
        <!-- レート換算表（全幅・最上部） -->
        <section class="card full-span">
            <div class="teamTitle">
                <div class="titleRow">
                    <h2>レート換算表</h2>
                    <div class="rateSummary" id="rateSummary">IRON 0〜?</div>
                </div>
                <button id="toggleRate" class="secondary small">詳細を表示</button>
            </div>
            <div class="tableGrid" id="rateTableWrap" style="display:none;">
                <div class="tableWrap compact">
                    <table>
                        <thead>
                            <tr>
                                <th>Tier</th>
                                <th>Division</th>
                                <th class="mono">ポイント</th>
                            </tr>
                        </thead>
                        <tbody id="scoreTableL"></tbody>
                    </table>
                </div>
                <div class="tableWrap compact">
                    <table>
                        <thead>
                            <tr>
                                <th>Tier</th>
                                <th>Division</th>
                                <th class="mono">ポイント</th>
                            </tr>
                        </thead>
                        <tbody id="scoreTableR"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- 入力 & 参加者 -->
        <section class="card layout-left">
            <div class="row">
                <div class="field">
                    <label>名前</label>
                    <input id="name" placeholder="例: Player1">
                </div>

                <div class="field">
                    <label>Tier</label>
                    <select id="tier">
                        <option>IRON</option>
                        <option>BRONZE</option>
                        <option>SILVER</option>
                        <option selected>GOLD</option>
                        <option>PLATINUM</option>
                        <option>EMERALD</option>
                        <option>DIAMOND</option>
                        <option>MASTER</option>
                        <option>GRANDMASTER</option>
                        <option>CHALLENGER</option>
                    </select>
                </div>

                <div class="field" id="divisionWrap">
                    <label>Division</label>
                    <select id="division">
                        <option>I</option>
                        <option>II</option>
                        <option>III</option>
                        <option selected>IV</option>
                    </select>
                </div>
            </div>

            <div class="row mt10">
                <div class="field">
                    <label>メインレーン</label>
                    <select id="mainLane">
                        <option>TOP</option>
                        <option>JG</option>
                        <option selected>MID</option>
                        <option>ADC</option>
                        <option>SUP</option>
                    </select>
                </div>

                <div class="field">
                    <label>サブレーン1（必須）</label>
                    <select id="subLane1">
                        <option>TOP</option>
                        <option selected>JG</option>
                        <option>MID</option>
                        <option>ADC</option>
                        <option>SUP</option>
                    </select>
                </div>

                <div class="field">
                    <label>サブレーン2（任意）</label>
                    <select id="subLane2">
                        <option value="NONE" selected>選択しない</option>
                        <option>TOP</option>
                        <option>JG</option>
                        <option>MID</option>
                        <option>ADC</option>
                        <option>SUP</option>
                    </select>
                    <div class="hint">未選択の場合は「選択しない」を選んでください。</div>
                </div>
            </div>

            <div class="row mt12">
                <button id="addBtn">追加</button>
                <button id="resetBtn" class="secondary">全消去</button>
                <span class="pill">off-lane: <span class="mono">tier-2（-2division）</span></span>
            </div>

            <div class="mt14">
                <div class="hint">参加者一覧（最大20人 / 2〜4チーム対応）</div>
                <div class="tableWrap">
                    <table>
                        <thead>
                            <tr>
                                <th>名前</th>
                                <th>ランク</th>
                                <th>メイン/サブ</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="list"></tbody>
                    </table>
                </div>
            </div>

            <!-- まとめて追加 -->
            <div class="card inner mt14">
                <div class="field">
                    <label>まとめて追加（1行1人、カンマ区切り）</label>
                    <textarea id="bulkInput" rows="5" placeholder="例: Player1, GOLD, IV, MID, JG&#10;Player2, PLATINUM, II, TOP, JG, SUP"></textarea>
                    <div class="hint">
                        フォーマット: 名前, tier, division(省略可), メイン, サブ1, (サブ2省略可)<br />
                        MASTER+の場合 division は空でもOK。
                    </div>
                </div>
                <div class="row mt10">
                    <button id="bulkAddBtn">まとめて追加</button>
                    <button id="exportBtn" class="secondary">JSONエクスポート</button>
                    <button id="importBtn" class="secondary">JSONインポート</button>
                    <input id="importFile" type="file" accept=".json,application/json" style="display:none;" />
                </div>
            </div>
        </section>

        <!-- 右カラム（設定 + 結果） -->
        <div class="rightCol layout-right">
            <section class="card">
                <div class="row">
                    <div class="field">
                        <label>チーム数</label>
                        <select id="teamCount">
                            <option value="2" selected>2チーム（10人）</option>
                            <option value="3">3チーム（15人）</option>
                            <option value="4">4チーム（20人）</option>
                        </select>
                        <div class="hint">参加者が必要人数より多い場合、最適な人数を自動抽出します。</div>
                    </div>

                    <div class="field">
                        <label>MATCHUP_WEIGHT（対面差の重視度）: <span id="wLabel" class="mono">2</span></label>
                        <input id="weight" type="range" min="0" max="4" step="1" value="2"
                            oninput="document.getElementById('wLabel').textContent = this.value"
                            onchange="document.getElementById('wLabel').textContent = this.value" />

                        <div class="hint">0にすると総合バランス優先。<br/>4にすると対面のレート差優先。</div>
                    </div>
                </div>

                <div class="field checkboxField">
                    <label><input id="strictLane" type="checkbox" /> メイン/サブのみで割り当てる</label>
                    <div id="strictWarn" class="hint" style="display:none;">
                        ※ メイン/サブ以外には置きません。割り当てできない/バランスが崩れる可能性があります。
                    </div>
                </div>

                <div class="row mt12">
                    <button id="buildBtn">チーム作成</button>
                    <span id="countHint" class="hint"></span>
                </div>

                <div class="card inner mt14">
                    <h3>トーナメント</h3>
                    <div class="row">
                        <div class="field">
                            <label>形式</label>
                            <select id="bracketMode">
                                <option value="single">シングルエリミ</option>
                                <option value="roundrobin">総当たりリーグ</option>
                                <option value="double">ダブルエリミ</option>
                            </select>
                        </div>
                        <div class="field">
                            <label>1回戦 / 準決勝 BO</label>
                            <select id="boSemi">
                                <option value="1">BO1</option>
                                <option value="3" selected>BO3</option>
                                <option value="5">BO5</option>
                            </select>
                        </div>
                        <div class="field">
                            <label>決勝 BO</label>
                            <select id="boFinal">
                                <option value="1">BO1</option>
                                <option value="3">BO3</option>
                                <option value="5" selected>BO5</option>
                            </select>
                        </div>
                        <div class="field">
                            <label>総当たり BO</label>
                            <select id="boRR">
                                <option value="1">BO1</option>
                                <option value="3" selected>BO3</option>
                                <option value="5">BO5</option>
                            </select>
                        </div>
                    </div>
                    <div class="hint">3チーム以上で「トーナメント表を生成」を押すと別タブに表示します（ラウンド別BOを適用）。</div>
                    <div class="row mt10">
                        <button id="bracketBtn" class="secondary">トーナメント表を生成</button>
                    </div>
                </div>
            </section>

            <!-- 結果（全幅） -->
            <section class="card full-span">
                <div class="teamTitle">
                    <h2>結果</h2>
                    <div id="overflowInfo" class="hint"></div>
                    <span id="resultMeta" class="pill">未作成</span>
                </div>

                <div id="resultArea" class="resultArea">
                    <div class="hint">参加者を追加して「チーム作成」を押してください。</div>
                </div>

                <div class="row mt10">
                    <button id="teamExportBtn" class="secondary">チームJSONエクスポート</button>
                    <button id="teamImportBtn" class="secondary">チームJSONインポート</button>
                    <input id="teamImportFile" type="file" accept=".json,application/json" style="display:none;" />
                </div>
            </section>

        </div>
    </main>

    <script src="app.js"></script>
</body>

</html>